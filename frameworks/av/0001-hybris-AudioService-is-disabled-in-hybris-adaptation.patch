From 654beaef72beee52cdc1d8d840e284e2b0c865a0 Mon Sep 17 00:00:00 2001
From: Simonas Leleiva <simonas.leleiva@meramo.co.uk>
Date: Sun, 30 Oct 2016 14:07:11 +0000
Subject: [PATCH 01/12] (hybris) AudioService is disabled in hybris adaptations
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Without this patch, camera is waiting for AudioService indefinitely

Change-Id: I27d0d515b53480833333d23da55a3e7e5afeb364
Signed-off-by: Simonas Leleiva <simonas.leleiva@jolla.com>
Signed-off-by: Bj√∂rn Bidar <theodorstormgrade@gmail.com>
---
 services/camera/libcameraservice/CameraService.cpp | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/services/camera/libcameraservice/CameraService.cpp b/services/camera/libcameraservice/CameraService.cpp
index 2d55f39..1dca676 100644
--- a/services/camera/libcameraservice/CameraService.cpp
+++ b/services/camera/libcameraservice/CameraService.cpp
@@ -3991,9 +3991,15 @@ void CameraService::increaseSoundRef() {
     mSoundRef++;
 }
 
+#if defined(__clang__)
+#pragma clang diagnostic push
+#pragma clang diagnostic ignored "-Wunused-parameter"
+#endif
 void CameraService::loadSoundLocked(sound_kind kind) {
     ATRACE_CALL();
 
+#pragma clang diagnostic pop
+#ifdef DISABLED_FOR_HYBRIS_SUPPORT
     LOG1("CameraService::loadSoundLocked ref=%d", mSoundRef);
     if (SOUND_SHUTTER == kind && mSoundPlayer[SOUND_SHUTTER] == NULL) {
         mSoundPlayer[SOUND_SHUTTER] = newMediaPlayer("/product/media/audio/ui/camera_click.ogg");
@@ -4012,6 +4018,7 @@ void CameraService::loadSoundLocked(sound_kind kind) {
             mSoundPlayer[SOUND_RECORDING_STOP] = newMediaPlayer("/system/media/audio/ui/VideoStop.ogg");
         }
     }
+#endif
 }
 
 void CameraService::decreaseSoundRef() {
-- 
2.45.2

